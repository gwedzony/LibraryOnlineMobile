<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewModel="clr-namespace:MauiApp1.ViewModel"
             x:Class="MauiApp1.Pages.BookcasesPage">
    <ContentPage.BindingContext>
        <viewModel:BookcasesViewModel/>
    </ContentPage.BindingContext>
    
    <ContentPage.Content>
        <CollectionView ItemsSource="{Binding BookcasesDtos}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border>
                       <Grid>
                           <Grid.RowDefinitions>
                               <RowDefinition Height="30"/>
                               <RowDefinition Height="*"/>
                           </Grid.RowDefinitions>
                            <StackLayout Orientation="Horizontal" HorizontalOptions="Center">
                                <Label 
                                    Text="{Binding Name}"
                                    VerticalTextAlignment="Center"
                                ></Label>
                                <ImageButton Source="editing.png" 
                                             Scale="0.5"
                                             Clicked="ImageButton_OnClicked"
                                />
                            </StackLayout>
                        <CollectionView Grid.Row="1" ItemsSource="{Binding Book}" 
                                        Margin="10" 
                                        ItemsLayout="VerticalList">
                           <CollectionView.ItemTemplate>
                <DataTemplate>
                 
                    <Grid Margin="0,10,0,10" ColumnSpacing="25">
                           <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <Image
                                   Source="okladka.jpg"
                                   Aspect="AspectFit"
                                   HeightRequest="60"
                                   WidthRequest="60" />
                            
                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions> 
                            <Label 
                                   Text="{Binding Title}"
                                   FontAttributes="Bold" 
                                   VerticalOptions="End"
                                   />
                            <Label Grid.Row="1"
                                   BackgroundColor="Red"
                                   Text="{Binding Author.Name}"
                                   FontAttributes="Italic"
                                   VerticalOptions="Start"
                                    />
                            </Grid>
                            
                            <Grid Grid.Column="2" Margin="100,0,0,0" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <ImageButton
                                    Source="play.png" 
                                    Scale="0.3"
                                />
                                <ImageButton Grid.Column="1"
                                    Source="delete.png"
                                    Scale="0.3"
                                    Command="{Binding 
                                    Source={RelativeSource AncestorType={x:Type viewModel:BookcasesViewModel}},  Path=DeleteCommand}"
                                    CommandParameter="{Binding Id}"
                                />
                            </Grid>
                        </Grid>
                  
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
                       </Grid> 
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        
     
    </ContentPage.Content>
</ContentPage>